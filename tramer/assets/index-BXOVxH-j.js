(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();let d;const A=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&A.decode();let g=null;function v(){return(g===null||g.byteLength===0)&&(g=new Uint8Array(d.memory.buffer)),g}function N(t,e){return t=t>>>0,A.decode(v().subarray(t,t+e))}let T=0;const E=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},M=typeof E.encodeInto=="function"?function(t,e){return E.encodeInto(t,e)}:function(t,e){const n=E.encode(t);return e.set(n),{read:t.length,written:n.length}};function O(t,e,n){if(n===void 0){const o=E.encode(t),l=e(o.length,1)>>>0;return v().subarray(l,l+o.length).set(o),T=o.length,l}let s=t.length,r=e(s,1)>>>0;const a=v();let i=0;for(;i<s;i++){const o=t.charCodeAt(i);if(o>127)break;a[r+i]=o}if(i!==s){i!==0&&(t=t.slice(i)),r=n(r,s,s=i+t.length*3,1)>>>0;const o=v().subarray(r+i,r+s),l=M(t,o);i+=l.written,r=n(r,s,i,1)>>>0}return T=i,r}function C(t){const e=d.__wbindgen_export_0.get(t);return d.__externref_table_dealloc(t),e}function D(t,e,n,s,r){const a=O(t,d.__wbindgen_malloc,d.__wbindgen_realloc),i=T,o=d.calculate_today_tl(a,i,e,n,s,r);if(o[2])throw C(o[1]);return o[0]}async function P(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(s){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function $(){const t={};return t.wbg={},t.wbg.__wbindgen_init_externref_table=function(){const e=d.__wbindgen_export_0,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t.wbg.__wbindgen_string_new=function(e,n){return N(e,n)},t}function j(t,e){return d=t.exports,S.__wbindgen_wasm_module=e,g=null,d.__wbindgen_start(),d}async function S(t){if(d!==void 0)return d;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL(""+new URL("tl_inflation_adjuster_bg-DLlMochP.wasm",import.meta.url).href,import.meta.url));const e=$();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:s}=await P(await t,e);return j(n,s)}let I=null;async function q(t){if(!/^\d{4}-\d{2}-\d{2}$/.test(t))throw new Error("Invalid historical date format. Use YYYY-MM-DD");const e=new Date(t);if(isNaN(e.getTime()))throw new Error("Invalid historical date.");I===null&&(I=await fetch("https://cpi-us.8credits.com/data.json").then(u=>u.json()));const s=I,r=s.firstYear,a=s.cpi;if(!r||!Array.isArray(a)||a.length===0)throw new Error("Invalid CPI data format");const i=e.getFullYear(),o=e.getMonth(),l=i-r;if(l<0||l>=a.length||!Array.isArray(a[l]))throw new Error("Historical CPI not available for the given year.");const p=a[l][o],m=parseFloat(p);if(isNaN(m))throw new Error("Historical CPI value not available for the month.");let b=null;for(let f=a.length-1;f>=0;f--){const u=a[f];if(Array.isArray(u)){for(let c=11;c>=0;c--){const h=u[c],y=parseFloat(h);if(!isNaN(y)){b=y;break}}if(b!==null)break}}if(b===null)throw new Error("No current CPI data available.");return b/m}document.addEventListener("DOMContentLoaded",async()=>{await S();const t=document.getElementById("converter-form"),e=document.getElementById("data-table"),n=document.getElementById("table-body"),s=document.getElementById("add-row"),r=document.getElementById("total-amount"),a=document.getElementById("result");function i(){const o=n.querySelectorAll(".amount-input");let l=0;o.forEach(p=>{const m=parseFloat(p.value)||0;l+=m}),r.textContent=`Toplam Hasar TL: ${l.toFixed(2)}`}s.addEventListener("click",()=>{const o=document.createElement("tr");o.innerHTML=`
			<td><input type="date" class="date-input" required /></td>
			<td><input type="number" class="amount-input" min="0" step="0.01" required></td>
			<td><input type="number" class="rate-input" min="0" step="0.0001" required /></td>
			<td><button type="button" class="remove-row">Sil</button></td>			
		`,n.appendChild(o),i()}),n.addEventListener("click",o=>{o.target.classList.contains("remove-row")&&(n.children.length>1?(o.target.closest("tr").remove(),i()):alert("At least one row is required"))}),n.addEventListener("input",o=>{o.target.classList.contains("amount-input")&&i()}),t.addEventListener("submit",async o=>{o.preventDefault();const l=n.querySelectorAll("tr");let p=[],m=!0,b=0,F=0;const f=parseFloat(e.querySelector(".current-rate-input").value);if(isNaN(f)){alert("Geçersiz güncel kur");return}for(let c=0;c<l.length;c++){const h=l[c],y=h.querySelector(".date-input").value,w=parseFloat(h.querySelector(".amount-input").value),x=parseFloat(h.querySelector(".rate-input").value),L=await q(y);if(!y||isNaN(w)){m=!1,p.push({row:c+1,date:y||"geçersiz",amount:isNaN(w)?"geçersiz":w.toFixed(2),adjusted:"geçersiz"});continue}try{const _=D(y,w,x,L,f);b+=w,F+=_,p.push({row:c+1,date:y,amount:w.toFixed(2),cpiFactor:`%${(L*100-100).toFixed(1)}`,rateFactor:`%${(f/x*100-100).toFixed(1)}`,adjusted:_.toFixed(2)})}catch(_){m=!1,p.push({row:c+1,date:y,amount:w.toFixed(2),cpiFactor:`%${(L*100-100).toFixed(1)}`,rateFactor:`%${(f/x*100-100).toFixed(1)}`,adjusted:`Error: ${_.message}`})}}let u='<h2>Sonuç</h2><table class="result-table"><thead><tr><th>Satır</th><th>Tarih</th><th>CPI Enflasyon</th><th>Kur Farkı</th><th>Orijinal TL</th><th>Ayarlanmış TL</th></tr></thead><tbody>';p.forEach(c=>{u+=`<tr><td>${c.row}</td><td>${c.date}</td><td>${c.cpiFactor}</td><td>${c.rateFactor}</td><td>${c.amount}</td><td>${c.adjusted}</td></tr>`}),u+=`<tr class="total-row"><td colspan="4">Toplam</td><td>${b.toFixed(2)}</td><td>${F.toFixed(2)}</td></tr>`,u+="</tbody></table",m||(u="<p>Hataları düzeltiniz:</p>"+u),a.innerHTML=u}),i()});
